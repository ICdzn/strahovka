[[extend "layout.html"]]

<div class="wrapper">
<div>
        <h4 class="title is-3">Укажите, к какой компании вы относитесь:</h4>
<select id="select_first" style="width:400px;" class="js-example-basic-single" ><option value="%null%"></option>
    [[for row in rows:]]
        <option value="[[=row.id]]">[[=row.IAN_FULL_NAME]]</option>
    [[pass]]
</select>
    <button id="add">Добавить</button>
    <label id="ok_add"></label><br>

    <h4 class="title is-3" style="margin-top:40px;">Укажите, какую компанию вы хотите удалить из своего списка</h4>
<select id="select_second" style="width:400px;" class="js-example-basic-single" ><option value="%null%"></option>
    [[for row in rows:]]
        <option value="[[=row.id]]">[[=row.IAN_FULL_NAME]]</option>
    [[pass]]
</select>
    <button id="delete_company">Удалить</button>
    <label id="ok_delete"></label><br>

    <h1 class="title is-5" style="margin-top:70px;">Информация о вашем аккаунте: </h1>
    <ul>
    <li>ID: [[=user.id]]</li>
    <li>Username: [[=user.username]]</li>
    <li>Email: [[=user.email]]</li>
    <li>First name: [[=user.first_name]]</li>
    <li>Last name: [[=user.last_name]]</li>
        <li><strong>Компании, к которым вы относитесь:</strong></li>
        [[for user_name in user.company_user.select():]]
        <li>[[=user_name.company_id.IAN_FULL_NAME]]</li>
        [[pass]]
    </ul>
</div>

<div>
<h2 class="title">Изменить свои данные: </h2>

[[=form]]


</div>
    </div>

<style>
.wrapper {
  display: grid;
  grid-template-columns: 650px 650px;
}

</style>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>
$(document).ready(function () {
        $(select_first).change(function() {
            var choice_id=this.value;
            console.log(choice_id);
                $(add).bind("click", function(){
                console.log(choice_id);
                        $.ajax({
                            type:"POST",
                            data: {'choice_id':choice_id},
                            url: 'add_company',
                            success: function(){$(ok_add).text('Добавлено')}
                            });
                        });
                    });
                });
</script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>
$(document).ready(function () {
        $(select_second).change(function() {
            var choice_id=this.value;
            console.log(choice_id);
                $(delete_company).bind("click", function(){
                console.log(choice_id);
                        $.ajax({
                            type:"POST",
                            data: {'choice_id':choice_id},
                            url: 'delete_company',
                            success: function(){$(ok_delete).text('Удалено')}
                            });
                        });
                    });
                });</script>
<link href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js"></script>
<script>
    $(document).ready(function() {
    $('.js-example-basic-single').select2();
});
</script>